
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This is technical docs site for wireless communication.">
      
      
        <meta name="author" content="Bo Yin">
      
      
        <link rel="canonical" href="https://boyin8.github.io/wireless-docs/channel_estimation/">
      
      
        <link rel="prev" href="../channel_models/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>Channel Estimation - Wireless Communication Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#2-channel-estimation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Wireless Communication Docs" class="md-header__button md-logo" aria-label="Wireless Communication Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Wireless Communication Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Channel Estimation
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/boyin8/wireless-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    boyin8/wireless-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../baseband_signal.md" class="md-tabs__link">
        
  
    
  
  Baseband Signal Model

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../channel_models/" class="md-tabs__link">
        
  
    
  
  Wireless Channel Models

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Channel Estimation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../ofdm.md" class="md-tabs__link">
        
  
    
  
  OFDM

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../channel_capacity.md" class="md-tabs__link">
        
  
    
  
  Channel Capacity

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../beamforming.md" class="md-tabs__link">
        
  
    
  
  Beamforming

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Wireless Communication Docs" class="md-nav__button md-logo" aria-label="Wireless Communication Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Wireless Communication Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/boyin8/wireless-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    boyin8/wireless-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../baseband_signal.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Baseband Signal Model
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../channel_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wireless Channel Models
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Channel Estimation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Channel Estimation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#21-what-is-channel-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 What is Channel Estimation?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.1 What is Channel Estimation?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#importance-of-channel-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      Importance of Channel Estimation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#22-channel-estimation-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Channel Estimation Techniques
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 Channel Estimation Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221-pilot-based-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.1 Pilot-based Estimation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-blind-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.2 Blind Estimation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#223-semi-blind-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      2.2.3 Semi-blind Estimation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#23-channel-estimation-in-ofdm-systems" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Channel Estimation in OFDM Systems
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#24-python-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Python Simulation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.4 Python Simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Code Implementation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#25-concludsion" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 Concludsion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ofdm.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OFDM
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../channel_capacity.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Channel Capacity
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../beamforming.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beamforming
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="2-channel-estimation"><strong>2. Channel Estimation</strong><a class="headerlink" href="#2-channel-estimation" title="Permanent link">&para;</a></h1>
<p>Accurate channel estimation is essential in wireless communication systems for efficient signal processing, especially in scenarios involving MIMO, OFDM, and beamforming techniques. It allows the transmitter or receiver to acquire knowledge of the channel state information (CSI), which is critical for equalization, interference mitigation, and adaptive modulation.</p>
<hr />
<h2 id="21-what-is-channel-estimation"><strong>2.1 What is Channel Estimation?</strong><a class="headerlink" href="#21-what-is-channel-estimation" title="Permanent link">&para;</a></h2>
<p>Channel estimation refers to the process of determining the channel characteristics between the transmitter and receiver. It involves estimating parameters such as:</p>
<ul>
<li>Path gains and delays.</li>
<li>Phase and amplitude distortions.</li>
<li>Frequency-selective or time-varying fading.</li>
</ul>
<h3 id="importance-of-channel-estimation">Importance of Channel Estimation<a class="headerlink" href="#importance-of-channel-estimation" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Equalization</strong>: Removes channel-induced distortions.</li>
<li><strong>Beamforming</strong>: Requires accurate CSI to align transmitted signals.</li>
<li><strong>Adaptive Modulation</strong>: Enables the system to dynamically adjust modulation schemes based on channel conditions.</li>
</ul>
<hr />
<h2 id="22-channel-estimation-techniques"><strong>2.2 Channel Estimation Techniques</strong><a class="headerlink" href="#22-channel-estimation-techniques" title="Permanent link">&para;</a></h2>
<p>Channel estimation methods can be broadly categorized based on the availability of pilot symbols and system assumptions:</p>
<h3 id="221-pilot-based-estimation"><strong>2.2.1 Pilot-based Estimation</strong><a class="headerlink" href="#221-pilot-based-estimation" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Pilot Symbols</strong>: Predefined symbols known to both transmitter and receiver are periodically inserted into the transmitted signal.</li>
<li>
<p><strong>Advantages</strong>:</p>
<ul>
<li>Provides accurate CSI for deterministic scenarios.</li>
<li>Well-suited for time-invariant or slow-fading channels.</li>
</ul>
</li>
<li>
<p><strong>Methods</strong>:</p>
<ol>
<li>
<p><strong>Least Squares (LS)</strong>:</p>
<ul>
<li>Solves for channel coefficients by minimizing the squared error between received and expected signals.</li>
<li>
<p>Formula:</p>
<div class="arithmatex">\[
  \boldsymbol{Y} = \boldsymbol{X}\boldsymbol{H} + \boldsymbol{Z}
\]</div>
<p>where <span class="arithmatex">\(\boldsymbol{Y}\)</span> is the received signal, <span class="arithmatex">\(\boldsymbol{X}\)</span> is the pilot symbol (diagonal matrix), <span class="arithmatex">\(\boldsymbol{Z}\)</span> is the noise, and <span class="arithmatex">\(\boldsymbol{H}\)</span> is the channel.</p>
<div class="arithmatex">\[
\begin{aligned}
J(\hat{\boldsymbol{H}}) &amp; =\|\boldsymbol{Y}-\boldsymbol{X} \hat{\boldsymbol{H}}\|^2 \\
&amp; =(\boldsymbol{Y}-\boldsymbol{X} \hat{\boldsymbol{H}})^{\mathrm{H}}(\boldsymbol{Y}-\boldsymbol{X} \hat{\boldsymbol{H}}) \\
&amp; =\boldsymbol{Y}^{\mathrm{H}} \boldsymbol{Y}-\boldsymbol{Y}^{\mathrm{H}} \boldsymbol{X} \hat{\boldsymbol{H}}-\hat{\boldsymbol{H}}^{\mathrm{H}} \boldsymbol{X}^{\mathrm{H}} \boldsymbol{Y}+\hat{\boldsymbol{H}}^{\mathrm{H}} \boldsymbol{X}^{\mathrm{H}} \boldsymbol{X} \hat{\boldsymbol{H}}.
\end{aligned}
\]</div>
<p>Let the partial derivative of <span class="arithmatex">\(J(\hat{\boldsymbol{H}})\)</span> with respect to <span class="arithmatex">\(\hat{\boldsymbol{H}}\)</span> be equal to 0,</p>
<div class="arithmatex">\[ \frac{\partial J(\hat{\boldsymbol{H}})}{\partial \hat{\boldsymbol{H}}}=-2\left(\boldsymbol{X}^{\mathrm{H}} \boldsymbol{Y}\right)^*+2\left(\boldsymbol{X}^{\mathrm{H}} \boldsymbol{X} \hat{\boldsymbol{H}}\right)^*=0.
\]</div>
<p>Then, we can get the solution of LS,</p>
<p>$$\hat{\boldsymbol{H}}_{\mathrm{LS}}=\left(\boldsymbol{X}^{\mathrm{H}} \boldsymbol{X}\right)^{-1} \boldsymbol{X}^{\mathrm{H}} \boldsymbol{Y}=\boldsymbol{X}^{-1} \boldsymbol{Y},
 $$</p>
<p>where <span class="arithmatex">\(\hat{\boldsymbol{H}}\)</span> denots the estimation of <span class="arithmatex">\(\boldsymbol{H}\)</span>. Furthermore, we can calculate the mean square error (MSE) of LS method as follows:</p>
<p>$$
  \begin{aligned}
  \mathrm{MSE}<em _mathrm_LS="\mathrm{LS">{\mathrm{LS}} &amp; =E\left{\left(\boldsymbol{H}-\hat{\boldsymbol{H}}</em>\right)\right} \
  &amp; =E\left{\left(\boldsymbol{H}-\boldsymbol{X}^{-1} \boldsymbol{Y}\right)^{\mathrm{H}}\left(\boldsymbol{H}-\boldsymbol{X}^{-1} \boldsymbol{r}\right)\right} \
  &amp; =E\left{\left(\boldsymbol{X}^{-1} \boldsymbol{Z}\right)^{\mathrm{H}}\left(\boldsymbol{X}^{-1} \boldsymbol{Z}\right)\right} \
  &amp; =E\left{\boldsymbol{Z}^{\mathrm{H}}\left(\boldsymbol{X}^{\mathrm{H}}\right)^{-1} \boldsymbol{Z}\right} \
  &amp; =\frac{\sigma_z^2}{\sigma_x^2}
  \end{aligned}
  $$}}\right)^{\mathrm{H}}\left(\boldsymbol{H}-\boldsymbol{H}_{\mathrm{LS}</p>
<p>where MSE is inversely proportional to the signal-to-noise (SNR) ratio, <span class="arithmatex">\(\frac{\sigma_x^2}{\sigma_z^2}\)</span>. This implies that the lower SNR, the less effective the LS is, because it amplifies the noise.</p>
</li>
</ul>
</li>
<li>
<p><strong>Minimum Mean Square Error (MMSE)</strong>:</p>
<ul>
<li>Incorporates noise statistics and prior knowledge of the channel.</li>
<li>Formula:</li>
</ul>
<p>$$
   \hat{H}<em LS="LS">{MMSE} = R_H (R_H + \sigma^2 I)^{-1} \hat{H}</em>,
   $$</p>
<p>where <span class="arithmatex">\(R_H\)</span> is the channel covariance matrix and <span class="arithmatex">\(\sigma^2\)</span> is noise variance.</p>
</li>
</ol>
</li>
<li>
<p><strong>LS vs. MMSE Comparison</strong></p>
<ol>
<li>
<p><strong>Noise Sensitivity</strong>:</p>
<ul>
<li>LS estimation is highly susceptible to noise, especially in low-SNR environments, as it does not account for noise statistics.</li>
<li>MMSE estimation leverages noise characteristics to suppress the impact of noise, providing superior accuracy in noisy conditions.</li>
</ul>
</li>
<li>
<p><strong>Use of Prior Information</strong>:</p>
<ul>
<li>LS estimation assumes no prior knowledge of the channel and performs a straightforward estimation.</li>
<li>MMSE estimation utilizes statistical properties of the channel (e.g., correlation, delay spread), resulting in a more robust estimation.</li>
</ul>
</li>
<li>
<p><strong>Complexity</strong>:</p>
<ul>
<li>LS estimation is computationally simple, requiring only a division operation, making it suitable for systems with stringent latency or processing constraints.</li>
<li>MMSE estimation involves matrix inversion and requires the covariance matrix, resulting in higher computational complexity.</li>
</ul>
</li>
<li>
<p><strong>Mean Square Error (MSE)</strong>:</p>
<ul>
<li>LS estimation minimizes instantaneous errors but does not guarantee the smallest MSE.</li>
<li>MMSE estimation explicitly minimizes the MSE, ensuring optimal performance in terms of estimation accuracy when channel statistics are available.</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="222-blind-estimation"><strong>2.2.2 Blind Estimation</strong><a class="headerlink" href="#222-blind-estimation" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Description</strong>: Estimates the channel without relying on pilot symbols, using the statistical properties of received signals.</li>
<li>
<p><strong>Advantages</strong>:</p>
<ul>
<li>Higher spectral efficiency due to no overhead for pilot symbols.</li>
</ul>
</li>
<li>
<p><strong>Challenges</strong>:</p>
<ul>
<li>Requires a large number of observations for accurate results.</li>
<li>Computationally complex.</li>
</ul>
</li>
</ul>
<h3 id="223-semi-blind-estimation"><strong>2.2.3 Semi-blind Estimation</strong><a class="headerlink" href="#223-semi-blind-estimation" title="Permanent link">&para;</a></h3>
<ul>
<li>Combines pilot-based and blind estimation techniques.</li>
<li>Uses pilot symbols for initial estimates and refines them using blind methods.</li>
</ul>
<hr />
<h2 id="23-channel-estimation-in-ofdm-systems"><strong>2.3 Channel Estimation in OFDM Systems</strong><a class="headerlink" href="#23-channel-estimation-in-ofdm-systems" title="Permanent link">&para;</a></h2>
<p>In OFDM systems, channel estimation faces unique challenges due to:
1. <strong>Frequency Selectivity</strong>:
   - Multipath propagation causes varying gains across subcarriers.
2. <strong>Pilot Subcarrier Allocation</strong>:
   - Pilots are inserted at specific subcarriers to estimate the channel at those frequencies, followed by interpolation for other subcarriers.
3. <strong>Interpolation Techniques</strong>:
   - <strong>Linear Interpolation</strong>:
     - Straightforward but may result in poor accuracy for rapidly changing channels.
   - <strong>Spline Interpolation</strong>:
     - Provides smoother transitions for high-variability channels.
   - <strong>DFT-based Interpolation</strong>:
     - Exploits the sparsity of the channel in the delay domain.</p>
<hr />
<h2 id="24-python-simulation"><strong>2.4 Python Simulation</strong><a class="headerlink" href="#24-python-simulation" title="Permanent link">&para;</a></h2>
<p>The following Python code demonstrates LS and MMSE-based channel estimation in an OFDM system.</p>
<h3 id="code-implementation"><strong>Code Implementation</strong><a class="headerlink" href="#code-implementation" title="Permanent link">&para;</a></h3>
<div class="language-py highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="n">H_est</span><span class="p">,</span> <span class="n">pilot_loc</span><span class="p">,</span> <span class="n">Nfft</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    Interpolates the channel estimate over all subcarriers.</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    Args:</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">        H_est (ndarray): Channel estimate using pilot sequence.</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">        pilot_loc (ndarray): Location of pilot sequence.</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">        Nfft (int): FFT size.</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">        method (str): Interpolation method (&#39;linear&#39; or &#39;spline&#39;).</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">        ndarray: Interpolated channel estimate over all subcarriers.</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="c1"># Extend at the beginning if necessary</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="k">if</span> <span class="n">pilot_loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        <span class="n">slope_start</span> <span class="o">=</span> <span class="p">(</span><span class="n">H_est</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">H_est</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">pilot_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pilot_loc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>        <span class="n">extrapolated_start</span> <span class="o">=</span> <span class="n">H_est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">slope_start</span> <span class="o">*</span> <span class="p">(</span><span class="n">pilot_loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>        <span class="n">H_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">H_est</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">extrapolated_start</span><span class="p">)</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>        <span class="n">pilot_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">pilot_loc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="c1"># Extend at the end if necessary</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    <span class="k">if</span> <span class="n">pilot_loc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Nfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>        <span class="n">slope_end</span> <span class="o">=</span> <span class="p">(</span><span class="n">H_est</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">H_est</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">pilot_loc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pilot_loc</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="n">extrapolated_end</span> <span class="o">=</span> <span class="n">H_est</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">slope_end</span> <span class="o">*</span> <span class="p">(</span><span class="n">Nfft</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">pilot_loc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>        <span class="n">H_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">H_est</span><span class="p">,</span> <span class="n">extrapolated_end</span><span class="p">)</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>        <span class="n">pilot_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pilot_loc</span><span class="p">,</span> <span class="n">Nfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>    <span class="c1"># Interpolate</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>        <span class="n">interp_fn</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">pilot_loc</span><span class="p">,</span> <span class="n">H_est</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>        <span class="n">interp_fn</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">pilot_loc</span><span class="p">,</span> <span class="n">H_est</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>    <span class="k">return</span> <span class="n">interp_fn</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Nfft</span><span class="p">))</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="k">def</span> <span class="nf">ls_channel_estimation</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Xp</span><span class="p">,</span> <span class="n">pilot_loc</span><span class="p">,</span> <span class="n">Nfft</span><span class="p">,</span> <span class="n">Nps</span><span class="p">,</span> <span class="n">int_opt</span><span class="p">):</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="sd">    LS channel estimation function.</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="sd">    Args:</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="sd">        Y (ndarray): Frequency-domain received signal.</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="sd">        Xp (ndarray): Pilot signal.</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="sd">        pilot_loc (ndarray): Pilot locations.</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="sd">        Nfft (int): FFT size.</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="sd">        Nps (int): Pilot spacing.</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="sd">        int_opt (str): Interpolation method (&#39;linear&#39; or &#39;spline&#39;).</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="sd">        ndarray: LS channel estimate.</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>    <span class="n">Np</span> <span class="o">=</span> <span class="n">Nfft</span> <span class="o">//</span> <span class="n">Nps</span>  <span class="c1"># Number of pilots</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>    <span class="n">LS_est</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">pilot_loc</span><span class="p">]</span> <span class="o">/</span> <span class="n">Xp</span>  <span class="c1"># LS channel estimation</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>    <span class="n">H_LS</span> <span class="o">=</span> <span class="n">interpolate</span><span class="p">(</span><span class="n">LS_est</span><span class="p">,</span> <span class="n">pilot_loc</span><span class="p">,</span> <span class="n">Nfft</span><span class="p">,</span> <span class="n">int_opt</span><span class="p">)</span>  <span class="c1"># Interpolation</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>    <span class="k">return</span> <span class="n">H_LS</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a><span class="k">def</span> <span class="nf">mmse_channel_estimation</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Xp</span><span class="p">,</span> <span class="n">pilot_loc</span><span class="p">,</span> <span class="n">Nfft</span><span class="p">,</span> <span class="n">Nps</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">SNR_dB</span><span class="p">):</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a><span class="sd">    MMSE channel estimation function.</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a><span class="sd">    Args:</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a><span class="sd">        Y (ndarray): Frequency-domain received signal.</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a><span class="sd">        Xp (ndarray): Pilot signal.</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a><span class="sd">        pilot_loc (ndarray): Pilot locations.</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a><span class="sd">        Nfft (int): FFT size.</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a><span class="sd">        Nps (int): Pilot spacing.</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a><span class="sd">        h (ndarray): Channel impulse response.</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a><span class="sd">        SNR_dB (float): Signal-to-Noise Ratio in dB.</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a><span class="sd">        ndarray: MMSE channel estimate.</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>    <span class="n">snr</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">SNR_dB</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Convert SNR to linear scale</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>    <span class="n">Np</span> <span class="o">=</span> <span class="n">Nfft</span> <span class="o">//</span> <span class="n">Nps</span>  <span class="c1"># Number of pilots</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>    <span class="n">H_tilde</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">pilot_loc</span><span class="p">]</span> <span class="o">/</span> <span class="n">Xp</span>  <span class="c1"># LS estimate</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>    <span class="c1"># Compute RMS delay spread from channel impulse response</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a>    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a>    <span class="n">hh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a>    <span class="n">tmp</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">/</span> <span class="n">hh</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>    <span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tmp</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span> <span class="o">/</span> <span class="n">hh</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>    <span class="n">tau_rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r2</span> <span class="o">-</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a>    <span class="c1"># Frequency-domain correlation</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>    <span class="n">df</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Nfft</span>  <span class="c1"># Subcarrier spacing</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>    <span class="n">j2pi_tau_df</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">tau_rms</span> <span class="o">*</span> <span class="n">df</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a>    <span class="c1"># Correlation matrices</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>    <span class="n">K1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Nfft</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Np</span><span class="p">))</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>    <span class="n">K2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Np</span><span class="p">),</span> <span class="p">(</span><span class="n">Nfft</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>    <span class="n">rf</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">j2pi_tau_df</span> <span class="o">*</span> <span class="p">(</span><span class="n">K1</span> <span class="o">-</span> <span class="n">K2</span> <span class="o">*</span> <span class="n">Nps</span><span class="p">))</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a>    <span class="n">K3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Np</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Np</span><span class="p">))</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>    <span class="n">K4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Np</span><span class="p">),</span> <span class="p">(</span><span class="n">Np</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>    <span class="n">rf2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">j2pi_tau_df</span> <span class="o">*</span> <span class="n">Nps</span> <span class="o">*</span> <span class="p">(</span><span class="n">K3</span> <span class="o">-</span> <span class="n">K4</span><span class="p">))</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a>    <span class="n">Rhp</span> <span class="o">=</span> <span class="n">rf</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>    <span class="n">Rpp</span> <span class="o">=</span> <span class="n">rf2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">Np</span><span class="p">)</span> <span class="o">/</span> <span class="n">snr</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>    <span class="n">H_MMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">Rhp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Rpp</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H_tilde</span><span class="p">)</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a>    <span class="k">return</span> <span class="n">H_MMSE</span>
</span></code></pre></div>
<hr />
<h2 id="25-concludsion"><strong>2.5 Concludsion</strong><a class="headerlink" href="#25-concludsion" title="Permanent link">&para;</a></h2>
<p>Channel estimation is a cornerstone of modern wireless communication systems, enabling equalization, beamforming, and adaptive modulation. Techniques like LS and MMSE are widely used due to their simplicity and accuracy, while interpolation methods ensure reliable channel estimates across all subcarriers in OFDM systems.</p>
<hr />
<h2 id="references"><strong>References</strong><a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>Cho, Yong Soo, Jaekwon Kim, Won Y. Yang, and Chung G. Kang. MIMO-OFDM wireless communications with MATLAB. John Wiley &amp; Sons, 2010.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../channel_models/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Wireless Channel Models">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Wireless Channel Models
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 ~ now | Bo Yin
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["header.autohide", "navigation.instant", "navigation.tracking", "content.code.annotate", "toc.integrate", "toc.follow", "navigation.path", "navigation.top", "navigation.tabs", "navigation.prune", "navigation.footer", "navigation.sections", "navigation.expand", "content.code.copy", "navigation.indexes", "search.share", "search.suggest"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>